var F=Object.defineProperty,S=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var y=(e,t,o)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(e,t)=>{for(var o in t||(t={}))w.call(t,o)&&y(e,o,t[o]);if(N)for(var o of N(t))A.call(t,o)&&y(e,o,t[o]);return e},u=(e,t)=>S(e,D(t));import{j as C,r as d,R as P,a as j}from"./vendor.a8b033c0.js";const R=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function o(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=o(l);fetch(l.href,a)}};R();const r=C.exports.jsx,c=C.exports.jsxs,v=C.exports.Fragment;function T(e){const t=()=>t,o=d.exports.createContext({state:e,update:t});function s(l){const[a,n]=d.exports.useState(e);return r(o.Provider,i({value:{state:a,update:n}},l))}return[o,s]}const $=e=>{const[t,o]=d.exports.useState(e);return{formData:t,setFormData:o,onChange:a=>{o(n=>u(i({},n),{[a.target.name]:a.target.value}))},resetForm:()=>o(i({},e))}},p=()=>{const e=(a,n)=>{var g;const m={accept:"application/json","Content-Type":"application/json"},b=new AbortController;return n.signal=b.signal,n.method=n.method||"GET",n.headers=n.headers?i(i({},m),n.headers):m,n.body=(g=JSON.stringify(n.body))!=null?g:!1,n.body||delete n.body,setTimeout(()=>b.abort(),1e4),fetch(a,n).then(h=>h.ok?h.json():Promise.reject({error:!0,status:h.status||500,message:h.statusText||"Hubo un problema"})).catch(h=>h)};return{get:(a,n={})=>e(a,n),post:(a,n={})=>(n.method="POST",e(a,n)),put:(a,n={})=>(n.method="PUT",e(a,n)),delete:(a,n={})=>(n.method="DELETE",e(a,n))}},q=()=>{const[e,t]=d.exports.useState({loading:!1,res:null,error:null});return{handleSubmit:s=>{t({loading:!0,res:null,error:null});const l=s.id?p().put:p().post;let a="https://api.probando.com/clientes";return s.id&&(a=`https://api.probando.com/clientes/${s.id}`),l(a,{body:s}).then(n=>(n.error?t({loading:!1,res:null,error:n.error}):t({loading:!1,res:n,error:null}),t(m=>u(i({},m),{loading:!1})),n))},data:e}},O=()=>{const e={nombres:"",apellidos:"",fecha_nacimiento:""},{state:t}=d.exports.useContext(f),{formData:o,setFormData:s,onChange:l,resetForm:a}=$(e),{data:n,handleSubmit:m}=q(),{update:b}=d.exports.useContext(f),g=async x=>{x.preventDefault(),(await m(o)).id&&(b(E=>u(i({},E),{refreshClientes:Date.now()})),a())},h=t.formCliente;return d.exports.useEffect(()=>{s(x=>i(i({},x),h))},[h]),c("form",{onSubmit:g,className:"my-4",children:[c("div",{className:"field",children:[r("label",{className:"label",children:"Nombres"}),r("div",{className:"control",children:r("input",{className:"input",type:"text",placeholder:"Nombres",name:"nombres",value:o.nombres,onChange:l,required:!0})})]}),c("div",{className:"field",children:[r("label",{className:"label",children:"Apellidos"}),r("div",{className:"control",children:r("input",{className:"input",type:"text",placeholder:"Apellidos",name:"apellidos",value:o.apellidos,onChange:l,required:!0})})]}),c("div",{className:"field",children:[r("label",{className:"label",children:"Fecha Nacimiento"}),r("div",{className:"control",children:r("input",{className:"input",type:"date",placeholder:"Seleccione una fecha",name:"fecha_nacimiento",value:o.fecha_nacimiento,onChange:l,required:!0})})]}),c("div",{className:"field is-grouped",children:[r("div",{className:"control",children:r("button",{className:"button is-link",type:"submit",disabled:n.loading,children:n.loading?"Enviando..":"Enviar"})}),r("div",{className:"control",children:r("button",{className:"button is-link is-light",type:"button",onClick:a,children:"Cancelar"})})]})]})},k=()=>{const{state:e}=d.exports.useContext(f),[t,o]=d.exports.useState({loading:!1,promedio:0,error:null}),s=async()=>{o(l=>u(i({},l),{loading:!0})),p().get("https://api.probando.com/clientes/promedio/edades").then(l=>{var a;console.log(l),l.error?o({loading:!1,promedio:0,error:l}):o({loading:!1,promedio:(a=l.promedio)!=null?a:0,error:null})}),o(l=>u(i({},l),{loading:!1}))};return d.exports.useEffect(()=>{s()},[e.refreshClientes]),u(i({},t),{fetchRequest:s})},H=()=>{const{promedio:e,loading:t,error:o}=k();return c(v,{children:[!t&&!o&&c("h1",{className:"has-text-centered is-size-4",children:["Promedio de Edad: ",e.toFixed(2)]}),!t&&o&&r("span",{children:"Hubo un problema al cargar el promedio"})]})},L=()=>{const[e,t]=d.exports.useState({loading:!1,rows:[],error:null}),o=async()=>{t(s=>u(i({},s),{loading:!0})),p().get("https://api.probando.com/clientes").then(s=>{s.error?t({loading:!1,rows:[],error:s}):t({loading:!1,rows:s!=null?s:[],error:null})}),t(s=>u(i({},s),{loading:!1}))};return u(i({},e),{fetchRequest:o})},_=()=>{const[e,t]=d.exports.useState({loading:!1,res:null,error:null});return{handleDelete:s=>(t({loading:!0,res:null,error:null}),p().delete(`https://api.probando.com/clientes/${s}`).then(l=>(l.error?t({loading:!1,res:null,error:l.error}):t({loading:!1,res:l,error:null}),t(a=>u(i({},a),{loading:!1})),l))),data:e}},M=({cliente:e})=>{const{data:t,handleDelete:o}=_(),{update:s}=d.exports.useContext(f);return c(v,{children:[r("button",{className:"button mr-3 is-warning is-small",title:"Editar",onClick:()=>{s(n=>u(i({},n),{formCliente:i({},e)}))},children:"Editar"}),r("button",{className:"button is-danger is-small",title:"Eliminar",onClick:async()=>{confirm(`Realmente desea eliminar al cliente: ${e.nombres}`)&&((await o(e.id)).error?alert("Hubo un problema al eliminar el cliente"):s(m=>u(i({},m),{refreshClientes:Date.now()})))},disabled:t.loading,children:t.loading?"Eliminando...":"Eliminar"})]})},z=({cliente:e})=>c("tr",{children:[r("td",{children:e.id}),c("td",{children:[e.nombres," ",e.apellidos]}),r("td",{children:e.fecha_nacimiento}),r("td",{children:e.edad}),r("td",{children:e.createdAt}),r("td",{children:e.updatedAt}),r("td",{children:r(M,{cliente:e})})]}),I=()=>{const{loading:e,rows:t,error:o,fetchRequest:s}=L(),{state:l}=d.exports.useContext(f),a=l.refreshClientes;return d.exports.useEffect(()=>{s()},[a]),r("div",{className:"table-container my-4",children:c("table",{className:"table is-bordered is-fullwidth",children:[r("thead",{children:c("tr",{children:[r("th",{children:"N"}),r("th",{children:"Cliente"}),r("th",{children:"Fecha Nacimiento"}),r("th",{children:"Edad"}),r("th",{children:"Creado"}),r("th",{children:"Actualizado"}),r("th",{children:"Acciones"})]})}),c("tbody",{children:[e&&r("tr",{children:r("td",{colSpan:10,className:"p-5 has-text-centered",children:"Cargando datos..."})}),!e&&o&&r("tr",{children:r("td",{colSpan:10,className:"p-5 has-text-centered",children:"Hubo un problema al cargar los datos"})}),!e&&!o&&!t.length&&r("tr",{children:r("td",{colSpan:10,className:"p-5 has-text-centered",children:"No hay clientes registrados"})}),!e&&t.map(n=>r(z,{cliente:n},n.id))]})]})})};const[B,U]=T({refreshClientes:0,formCliente:{}}),f=B;function G(){return r(U,{children:c("div",{className:"container",children:[r("h1",{className:"is-size-3",children:"App Clientes"}),r(O,{}),r(H,{}),r(I,{})]})})}P.render(r(j.StrictMode,{children:r(G,{})}),document.getElementById("root"));
